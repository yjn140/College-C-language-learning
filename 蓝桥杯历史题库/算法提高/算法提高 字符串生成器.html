<head>
    <meta charset="UTF-8">
<title>算法提高 字符串生成器</title>
<link rel="stylesheet" href="../css/main.css">
</head>
 <p>【问题描述】</p>
<p>有一个字符串生成器，初始时生成的字符串为空串，它每次按照给定概率随机生成一个小写字母，加在当前已生成字符串的后面。</p>
<p>给定N个长度为L的字符串，每个字符串由小写字母组成。</p>
<p>如果在某个时候，发现每个给定字符串都在当前已生成的字符串中作为子串出现过，生成器就会停下来，将当前生成的字符串作为输出。</p>
<p>求输出字符串长度的期望值。</p>
<p>【输入格式】</p>
<p>第一行包含一个正整数C，表示有C组数据。</p>
<p>每组数据的第一行包含三个正整数N, L, T (L&lt;=6, T&lt;=10)。其中T表示生成器仅会生成前T个小写字母。</p>
<p>每组数据的第2~N+1行，每行包含一个长度为L的字符串，每个字符串由前T个小写英文字母组成。</p>
<p>每组数据的第N+2行包含T个不超过10000的正整数，设第i个正整数为x，那么字符串生成器生成第i个小写字母的概率为x/10000。输入保证这T个正整数之和为10000。</p>
<p>【输出格式】<br />
包含C行，依次对应每组数据。每行包含一个实数，表示输出字符串长度的期望值。<br />
【样例输入】</p>
<p>1</p>
<p>2 3 3</p>
<p>aac</p>
<p>abb</p>
<p>3333 3333 3334</p>
<p>【样例输出】<br />
40.5060771264<br />
【数据规模和约定】</p>
<p>本题共10个测试点。</p>
<p>对于30%的数据，N=1, C=1；</p>
<p>对于60%的数据，N&lt;=4, C&lt;=2；</p>
<p>对于100%的数据，N&lt;=8, C&lt;=20。</p>
<p>其中N=1的数据中存在一个测试点，只有你的答案和我们的答案相差小于1才为正确，并且这个测试点中L=3, T=3；</p>
<p>对于其他9个测试点，只有你的答案和我们的答案相差小于0.01才为正确。</p>
<p>数据保证正确答案不会超过5*10^6。</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>