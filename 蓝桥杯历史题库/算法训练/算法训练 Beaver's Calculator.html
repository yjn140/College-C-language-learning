<head>
    <meta charset="UTF-8">
<title>算法训练 Beaver's Calculator</title>
<link rel="stylesheet" href="../css/main.css">
</head>
 <p>【问题描述】</p>
<p>&nbsp;</p>
<p><span class="Apple-tab-span" style="white-space:pre">	</span>从万能词典来的聪明的海狸已经使我们惊讶了一次。他开发了一种新的计算器，他将此命名为&quot;Beaver's Calculator 1.0&quot;。它非常特别，并且被计划使用在各种各样的科学问题中。</p>
<p><span class="Apple-tab-span" style="white-space:pre">	</span>为了测试它，聪明的海狸邀请了n位科学家，编号从1到n。第i位科学家给这个计算器带来了&nbsp;<i style="color: rgb(34, 34, 34); font-family: 'times new roman', sans-serif; font-size: 18px; line-height: 21px; ">k</i><sub class="lower-index" style="color: rgb(34, 34, 34); font-family: 'times new roman', sans-serif; font-size: 13px; line-height: 0; position: relative; vertical-align: baseline; bottom: -0.25em; "><i>i</i></sub>个计算题。第i个科学家带来的问题编号1到n，并且它们必须按照编号一个一个计算，因为对于每个问题的计算都必须依赖前一个问题的计算结果。</p>
<p><span class="Apple-tab-span" style="white-space:pre">	</span>每个教授的每个问题都用一个数&nbsp;&nbsp;<i style="color: rgb(34, 34, 34); font-family: 'times new roman', sans-serif; font-size: 18px; line-height: 21px; ">a</i><sub class="lower-index" style="font-size: 13px; line-height: 0; position: relative; vertical-align: baseline; bottom: -0.25em; color: rgb(34, 34, 34); font-family: 'times new roman', sans-serif; "><i>i</i>,&thinsp;<i>j</i></sub><span style="color: rgb(34, 34, 34); font-family: 'times new roman', sans-serif; font-size: 18px; line-height: 21px; ">&thinsp;</span>&nbsp;来描述，i（1&le;i&le;n）是科学家的编号，j（1&le;j&le; <i style="color: rgb(34, 34, 34); font-family: 'times new roman', sans-serif; font-size: 18px; line-height: 21px; ">k</i><sub class="lower-index" style="color: rgb(34, 34, 34); font-family: 'times new roman', sans-serif; font-size: 13px; line-height: 0; position: relative; vertical-align: baseline; bottom: -0.25em; "><i>i</i></sub>&nbsp;）是问题的编号， <i style="color: rgb(34, 34, 34); font-family: 'times new roman', sans-serif; font-size: 18px; line-height: 21px; ">a</i><sub class="lower-index" style="font-size: 13px; line-height: 0; position: relative; vertical-align: baseline; bottom: -0.25em; color: rgb(34, 34, 34); font-family: 'times new roman', sans-serif; "><i>i</i>,&thinsp;<i>j</i></sub><span style="color: rgb(34, 34, 34); font-family: 'times new roman', sans-serif; font-size: 18px; line-height: 21px; ">&thinsp;</span>&nbsp;表示解决这个问题所需资源单位的数量。</p>
<p><span class="Apple-tab-span" style="white-space:pre">	</span>这个计算器非常不凡。它一个接一个的解决问题。在一个问题解决后，并且在下一个问题被计算前，计算器分配或解放资源。</p>
<p><span class="Apple-tab-span" style="white-space:pre">	</span>计算器中最昂贵的操作是解放资源，解放远远慢于分配。所以对计算器而言，每一个接下来的问题所需的资源不少于前一个，是非常重要的。</p>
<p><span class="Apple-tab-span" style="white-space:pre">	</span>给你关于这些科学家所给问题的相关信息。你需要给这些问题安排一个顺序，使得&ldquo;坏对&rdquo;尽可能少。</p>
<p>所谓&ldquo;坏对&rdquo;，就是相邻两个问题中，后一个问题需求的资源比前一个问题少。别忘了，对于同一个科学家给出的问题，计算它们的相对顺序必须是固定的。</p>
<p>【输入格式】</p>
<p>第一行包含一个整数n，表示科学家的人数。接下来n行每行有5个整数，<span class="tex-span" style="font-size: 18px; font-family: 'times new roman', sans-serif; color: rgb(34, 34, 34); line-height: 21px; "><i>k</i><sub class="lower-index" style="font-size: 13px; line-height: 0; position: relative; vertical-align: baseline; bottom: -0.25em; "><i>i</i></sub></span><span style="color: rgb(34, 34, 34); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: 14px; line-height: 21px; ">,&nbsp;</span><span class="tex-span" style="font-size: 18px; font-family: 'times new roman', sans-serif; color: rgb(34, 34, 34); line-height: 21px; "><i>a</i><sub class="lower-index" style="font-size: 13px; line-height: 0; position: relative; vertical-align: baseline; bottom: -0.25em; "><i>i</i>,&thinsp;1</sub></span><span style="color: rgb(34, 34, 34); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: 14px; line-height: 21px; ">,&nbsp;</span><span class="tex-span" style="font-size: 18px; font-family: 'times new roman', sans-serif; color: rgb(34, 34, 34); line-height: 21px; "><i>x</i><sub class="lower-index" style="font-size: 13px; line-height: 0; position: relative; vertical-align: baseline; bottom: -0.25em; "><i>i</i></sub></span><span style="color: rgb(34, 34, 34); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: 14px; line-height: 21px; ">,&nbsp;</span><span class="tex-span" style="font-size: 18px; font-family: 'times new roman', sans-serif; color: rgb(34, 34, 34); line-height: 21px; "><i>y</i><sub class="lower-index" style="font-size: 13px; line-height: 0; position: relative; vertical-align: baseline; bottom: -0.25em; "><i>i</i></sub></span><span style="color: rgb(34, 34, 34); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: 14px; line-height: 21px; ">,&nbsp;</span><span class="tex-span" style="font-size: 18px; font-family: 'times new roman', sans-serif; color: rgb(34, 34, 34); line-height: 21px; "><i>m</i><sub class="lower-index" style="font-size: 13px; line-height: 0; position: relative; vertical-align: baseline; bottom: -0.25em; "><i>i</i></sub></span><span style="color: rgb(34, 34, 34); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: 14px; line-height: 21px; ">&nbsp;(</span><span class="tex-span" style="font-size: 18px; font-family: 'times new roman', sans-serif; color: rgb(34, 34, 34); line-height: 21px; ">0&thinsp;&le;&thinsp;<i>a</i><sub class="lower-index" style="font-size: 13px; line-height: 0; position: relative; vertical-align: baseline; bottom: -0.25em; "><i>i</i>,&thinsp;1</sub>&thinsp;&lt;&thinsp;<i>m</i><sub class="lower-index" style="font-size: 13px; line-height: 0; position: relative; vertical-align: baseline; bottom: -0.25em; "><i>i</i></sub>&thinsp;&le;&thinsp;10<sup class="upper-index" style="font-size: 13px; line-height: 0; position: relative; vertical-align: baseline; top: -0.5em; ">9</sup></span><span style="color: rgb(34, 34, 34); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: 14px; line-height: 21px; ">,&nbsp;</span><span class="tex-span" style="font-size: 18px; font-family: 'times new roman', sans-serif; color: rgb(34, 34, 34); line-height: 21px; ">1&thinsp;&le;&thinsp;<i>x</i><sub class="lower-index" style="font-size: 13px; line-height: 0; position: relative; vertical-align: baseline; bottom: -0.25em; "><i>i</i></sub>,&thinsp;<i>y</i><sub class="lower-index" style="font-size: 13px; line-height: 0; position: relative; vertical-align: baseline; bottom: -0.25em; "><i>i</i></sub>&thinsp;&le;&thinsp;10<sup class="upper-index" style="font-size: 13px; line-height: 0; position: relative; vertical-align: baseline; top: -0.5em; ">9</sup></span><span style="color: rgb(34, 34, 34); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: 14px; line-height: 21px; ">)&nbsp;</span>，分别表示第i个科学家的问题个数，第1个问题所需资源单位数，以及3个用来计算 <i style="color: rgb(34, 34, 34); font-family: 'times new roman', sans-serif; font-size: 18px; line-height: 21px; ">a</i><sub class="lower-index" style="font-size: 13px; line-height: 0; position: relative; vertical-align: baseline; bottom: -0.25em; color: rgb(34, 34, 34); font-family: 'times new roman', sans-serif; "><i>i</i>,&thinsp;<i>j</i></sub>&nbsp;的参量。<i style="color: rgb(34, 34, 34); font-family: 'times new roman', sans-serif; font-size: 18px; line-height: 21px; ">a</i><sub class="lower-index" style="font-size: 13px; line-height: 0; position: relative; vertical-align: baseline; bottom: -0.25em; color: rgb(34, 34, 34); font-family: 'times new roman', sans-serif; "><i>i</i>,&thinsp;<i>j</i></sub><span style="color: rgb(34, 34, 34); font-family: 'times new roman', sans-serif; font-size: 18px; line-height: 21px; ">&thinsp;=&thinsp;(</span><i style="color: rgb(34, 34, 34); font-family: 'times new roman', sans-serif; font-size: 18px; line-height: 21px; ">a</i><sub class="lower-index" style="font-size: 13px; line-height: 0; position: relative; vertical-align: baseline; bottom: -0.25em; color: rgb(34, 34, 34); font-family: 'times new roman', sans-serif; "><i>i</i>,&thinsp;<i>j</i>&thinsp;-&thinsp;1</sub><span style="color: rgb(34, 34, 34); font-family: 'times new roman', sans-serif; font-size: 18px; line-height: 21px; ">&thinsp;*&thinsp;</span><i style="color: rgb(34, 34, 34); font-family: 'times new roman', sans-serif; font-size: 18px; line-height: 21px; ">x</i><sub class="lower-index" style="font-size: 13px; line-height: 0; position: relative; vertical-align: baseline; bottom: -0.25em; color: rgb(34, 34, 34); font-family: 'times new roman', sans-serif; "><i>i</i></sub><span style="color: rgb(34, 34, 34); font-family: 'times new roman', sans-serif; font-size: 18px; line-height: 21px; ">&thinsp;+&thinsp;</span><i style="color: rgb(34, 34, 34); font-family: 'times new roman', sans-serif; font-size: 18px; line-height: 21px; ">y</i><sub class="lower-index" style="font-size: 13px; line-height: 0; position: relative; vertical-align: baseline; bottom: -0.25em; color: rgb(34, 34, 34); font-family: 'times new roman', sans-serif; "><i>i</i></sub><span style="color: rgb(34, 34, 34); font-family: 'times new roman', sans-serif; font-size: 18px; line-height: 21px; ">)</span><span class="tex-span" style="font-size: 18px; font-family: 'times new roman', sans-serif; color: rgb(34, 34, 34); line-height: 21px; "><i>mod</i></span><span style="color: rgb(34, 34, 34); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: 14px; line-height: 21px; ">&nbsp;</span><span class="tex-span" style="font-size: 18px; font-family: 'times new roman', sans-serif; color: rgb(34, 34, 34); line-height: 21px; "><i>m</i><sub class="lower-index" style="font-size: 13px; line-height: 0; position: relative; vertical-align: baseline; bottom: -0.25em; "><i>i。</i></sub></span></p>
<p>【输出格式】</p>
<p>第一行输出一个整数，表示最优顺序下最少的&ldquo;坏对&rdquo;个数。</p>
<p>如果问题的总个数不超过200000,接下来输出 <img align="middle" class="tex-formula" style="border-top-width: medium; border-right-width: medium; border-bottom-width: medium; border-left-width: medium; border-style: initial; border-color: initial; border-image: initial; font-family: 'times new roman', sans-serif; vertical-align: middle; margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; border-top-style: none; border-right-style: none; border-bottom-style: none; border-left-style: none; border-color: initial; position: relative; bottom: 2px; color: rgb(34, 34, 34); font-size: 14px; line-height: 21px; " alt="" src="http://codeforces.ru/renderer/a16730dcbb2402871e20647c8aba55beada5c1b6.png" />&nbsp;行，表示解决问题的最优顺序。每一行两个用空格隔开的整数，表示这个问题所需的资源单位数和提供这个问题的科学家的编号。<br />
【样例输入】</p>
<p><span style="color: rgb(136, 0, 0); font-family: Consolas, 'Lucida Console', 'Andale Mono', 'Bitstream Vera Sans Mono', 'Courier New', Courier; font-size: 13px; line-height: 1.25em; white-space: pre-wrap; ">2</span></p>
<p>2 1 1 1 10</p>
<p>2 3 1 1 10</p>
<p>【样例输出】</p>
<p>0</p>
<p>1 1</p>
<p>2 1</p>
<p>3 2</p>
<p>4 2</p>
<p>【数据规模和约定】</p>
<p>&nbsp;</p>
<p>20%的数据<span style="color: rgb(34, 34, 34); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: 14px; line-height: 21px; ">&nbsp;</span><span class="tex-span" style="font-size: 18px; font-family: 'times new roman', sans-serif; color: rgb(34, 34, 34); line-height: 21px; "><i>n</i>&thinsp;=&thinsp;2</span><span style="color: rgb(34, 34, 34); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: 14px; line-height: 21px; ">,&nbsp;</span><span class="tex-span" style="font-size: 18px; font-family: 'times new roman', sans-serif; color: rgb(34, 34, 34); line-height: 21px; ">1&thinsp;&le;&thinsp;<i>k</i><sub class="lower-index" style="font-size: 13px; line-height: 0; position: relative; vertical-align: baseline; bottom: -0.25em; "><i>i</i></sub>&thinsp;&le;&thinsp;2000</span><span class="tex-span" style="color: rgb(34, 34, 34); line-height: 21px; font-size: 14px;"><font face="'Helvetica Neue', Helvetica, Arial, sans-serif">；</font></span></p>
<p>另外30%的数据<span style="color: rgb(34, 34, 34); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: 14px; line-height: 21px; ">&nbsp;</span><span class="tex-span" style="font-size: 18px; font-family: 'times new roman', sans-serif; color: rgb(34, 34, 34); line-height: 21px; "><i>n</i>&thinsp;=&thinsp;2</span><span style="color: rgb(34, 34, 34); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: 14px; line-height: 21px; ">,&nbsp;</span><span class="tex-span" style="font-size: 18px; font-family: 'times new roman', sans-serif; color: rgb(34, 34, 34); line-height: 21px; ">1&thinsp;&le;&thinsp;<i>k</i><sub class="lower-index" style="font-size: 13px; line-height: 0; position: relative; vertical-align: baseline; bottom: -0.25em; "><i>i</i></sub>&thinsp;&le;&thinsp;200000</span><span style="color: rgb(34, 34, 34); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: 14px; line-height: 21px; ">；</span></p>
<p>剩下50%的数据<span style="color: rgb(34, 34, 34); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: 14px; line-height: 21px; ">&nbsp;</span><span style="color: rgb(34, 34, 34); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: 14px; line-height: 21px; ">&nbsp;</span><span class="tex-span" style="font-size: 18px; font-family: 'times new roman', sans-serif; color: rgb(34, 34, 34); line-height: 21px; ">1&thinsp;&le;&thinsp;<i>n</i>&thinsp;&le;&thinsp;5000</span><span style="color: rgb(34, 34, 34); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: 14px; line-height: 21px; ">,&nbsp;</span><span class="tex-span" style="font-size: 18px; font-family: 'times new roman', sans-serif; color: rgb(34, 34, 34); line-height: 21px; ">1&thinsp;&le;&thinsp;<i>k</i><sub class="lower-index" style="font-size: 13px; line-height: 0; position: relative; vertical-align: baseline; bottom: -0.25em; "><i>i</i></sub>&thinsp;&le;&thinsp;5000</span><span style="color: rgb(34, 34, 34); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: 14px; line-height: 21px; ">。</span></p>
<p>&nbsp;</p>