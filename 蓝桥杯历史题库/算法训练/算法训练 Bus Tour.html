<head>
    <meta charset="UTF-8">
<title>算法训练 Bus Tour</title>
<link rel="stylesheet" href="../css/main.css">
</head>
 <p>【问题描述】</p>
<p class="p0" style="margin-bottom:0pt; margin-top:0pt; "><span style="mso-spacerun:'yes'; font-size:10.5000pt; font-family:'宋体'; ">想象你是一个在<font face="Times New Roman">Warsaw</font><font face="宋体">的游客，而且预订了一次乘车旅行，去城镇外看一些令人惊异的景点。这辆公共汽车首先围绕城镇行驶一段时间（一段很长的时间，由于</font><font face="Times New Roman">Warsaw</font><font face="宋体">是一个大城市），把在各自旅馆的人们带上。接着它就去了那个令人惊异的景点，几个小时后又回到城市中，再一次行驶到每一个旅馆，这一次把乘客放下。</font></span><span style="mso-spacerun:'yes'; font-size:10.5000pt; font-family:'Times New Roman'; "><o:p></o:p></span></p>
<p class="p0" style="margin-bottom:0pt; margin-top:0pt; "><span style="mso-spacerun:'yes'; font-size:10.5000pt; font-family:'Times New Roman'; ">	</span><span style="mso-spacerun:'yes'; font-size:10.5000pt; font-family:'Times New Roman'; ">由于某种原因</span><span style="mso-spacerun:'yes'; font-size:10.5000pt; font-family:'宋体'; ">，每当你这样做的时候，你的旅馆总是第一个要上车的，而且是最后一个才下车的，意味着你不得不忍受两段经过所有当地旅馆的不那么愉快的旅行。这很明显不是你想要做的事（除非由于某种原因你真的要进入那些旅馆），所以让我们来做个改变。我们将开发一些软件使得那些观光公司能够把它们的乘车旅行路线安排得更公平&mdash;&mdash;尽管这有时候可能会导致每一个人的总距离更长，但公平就是公平，不是吗？</span><span style="mso-spacerun:'yes'; font-size:10.5000pt; font-family:'Times New Roman'; "><o:p></o:p></span></p>
<p class="p0" style="margin-bottom:0pt; margin-top:0pt; "><span style="mso-spacerun:'yes'; font-size:10.5000pt; font-family:'Times New Roman'; ">	</span><span style="mso-spacerun:'yes'; font-size:10.5000pt; font-family:'Times New Roman'; ">对于这个问题</span><span style="mso-spacerun:'yes'; font-size:10.5000pt; font-family:'宋体'; ">，</span><span style="mso-spacerun:'yes'; font-size:10.5000pt; font-family:'Times New Roman'; ">有一个起始位置</span><span style="mso-spacerun:'yes'; font-size:10.5000pt; font-family:'宋体'; ">（观光公司的总部），<font face="Times New Roman">h</font><font face="宋体">个需要接送游客的旅馆和一个目的地位置（令人惊异的景点）。我们需要找到一条路径，从总部出发，经过所有的旅馆，到景点去，再回来再一次经过所有的旅馆（可能按照不同的顺序），最后返回总部。为了保证没有一个游客（特别是你）被迫忍受两个完整的旅馆旅行，我们要求在去景点的路上接游客的前<img src="http://lx.lanqiao.cn/RequireFile.do?fid=R66EGmmT" width="53" height="25" alt="" /></font></span><span style="mso-spacerun:'yes'; font-size:10.5000pt; font-family:'Times New Roman'; ">个旅馆</span><span style="mso-spacerun:'yes'; font-size:10.5000pt; font-family:'宋体'; ">，</span><span style="mso-spacerun:'yes'; font-size:10.5000pt; font-family:'Times New Roman'; ">在回来的路上也得是前</span><img src="http://lx.lanqiao.cn/RequireFile.do?fid=R66EGmmT" width="53" height="25" style="font-family: 宋体; font-size: 14px;" alt="" /><span style="font-size: 10.5pt; font-family: 'Times New Roman';">个让游客下车的</span><span style="font-size: 10.5pt; font-family: 宋体;">。受制于这些限制条件，我们想让整个公车旅行尽可能短。注意这些限制条件可能会迫使公共汽车经过某个旅馆但是不停下来（这不算做让游客下车），后来再来这里让游客下车，样例就说明了这种情况。</span></p>
<p>【输入格式】</p>
<p class="p0" style="margin-bottom:0pt; margin-top:0pt; "><span style="mso-spacerun:'yes'; font-size:10.5000pt; font-family:'Times New Roman'; ">第一行包含两个整数<font face="Times New Roman">n</font><font face="宋体">和</font><font face="Times New Roman">m</font><font face="宋体">满足</font></span><span style="mso-spacerun:'yes'; font-size:10.5000pt; font-family:'宋体'; ">3<font face="宋体">&le;</font><font face="Times New Roman">n</font><font face="宋体">&le;</font><font face="Times New Roman">20,2</font><font face="宋体">&le;</font><font face="Times New Roman">m</font><font face="宋体">，</font><font face="Times New Roman">n</font><font face="宋体">是位置的总数（旅馆，总部和景点），</font><font face="Times New Roman">m</font><font face="宋体">是汽车能在两个位置之间行驶的路径条数。</font></span><span style="mso-spacerun:'yes'; font-size:10.5000pt; font-family:'Times New Roman'; "><o:p></o:p></span></p>
<p class="p0" style="margin-bottom:0pt; margin-top:0pt; "><span style="mso-spacerun:'yes'; font-size:10.5000pt; font-family:'Times New Roman'; ">	</span><span style="mso-spacerun:'yes'; font-size:10.5000pt; font-family:'Times New Roman'; ">n<font face="宋体">个不同的位置被标号为</font></span><span style="mso-spacerun:'yes'; font-size:10.5000pt; font-family:'宋体'; ">0<font face="宋体">到</font><font face="Times New Roman">n-</font></span><span style="mso-spacerun:'yes'; font-size:10.5000pt; font-family:'Times New Roman'; ">1</span><span style="mso-spacerun:'yes'; font-size:10.5000pt; font-family:'宋体'; ">,0<font face="宋体">是总部，</font><font face="Times New Roman">1</font><font face="宋体">到</font><font face="Times New Roman">n-</font></span><span style="mso-spacerun:'yes'; font-size:10.5000pt; font-family:'Times New Roman'; ">2<font face="宋体">是旅馆</font></span><span style="mso-spacerun:'yes'; font-size:10.5000pt; font-family:'宋体'; ">，</span><span style="mso-spacerun:'yes'; font-size:10.5000pt; font-family:'Times New Roman'; ">而<font face="Times New Roman">n</font></span><span style="mso-spacerun:'yes'; font-size:10.5000pt; font-family:'宋体'; ">-</span><span style="mso-spacerun:'yes'; font-size:10.5000pt; font-family:'Times New Roman'; ">1<font face="宋体">是景点</font></span><span style="mso-spacerun:'yes'; font-size:10.5000pt; font-family:'宋体'; ">。</span><span style="mso-spacerun:'yes'; font-size:10.5000pt; font-family:'Times New Roman'; ">假定任意一对位置之间最多只有一条直接路径</span><span style="mso-spacerun:'yes'; font-size:10.5000pt; font-family:'宋体'; ">，</span><span style="mso-spacerun:'yes'; font-size:10.5000pt; font-family:'Times New Roman'; ">而且从任意一个位置都能到达任意另一个位置</span><span style="mso-spacerun:'yes'; font-size:10.5000pt; font-family:'宋体'; ">（并不一定直接到达）。</span><span style="mso-spacerun:'yes'; font-size:10.5000pt; font-family:'Times New Roman'; "><o:p></o:p></span></p>
<p class="p0" style="margin-bottom:0pt; margin-top:0pt; "><span style="mso-spacerun:'yes'; font-size:10.5000pt; font-family:'Times New Roman'; ">	</span><span style="mso-spacerun:'yes'; font-size:10.5000pt; font-family:'Times New Roman'; ">接下来<font face="Times New Roman">m</font><font face="宋体">行</font></span><span style="mso-spacerun:'yes'; font-size:10.5000pt; font-family:'宋体'; ">，</span><span style="mso-spacerun:'yes'; font-size:10.5000pt; font-family:'Times New Roman'; ">每行包含三个整数<font face="Times New Roman">u</font></span><span style="mso-spacerun:'yes'; font-size:10.5000pt; font-family:'宋体'; ">，</span><span style="mso-spacerun:'yes'; font-size:10.5000pt; font-family:'Times New Roman'; ">v<font face="宋体">和</font><font face="Times New Roman">t</font></span><span style="mso-spacerun:'yes'; font-size:10.5000pt; font-family:'宋体'; ">，</span><span style="mso-spacerun:'yes'; font-size:10.5000pt; font-family:'Times New Roman'; ">满足</span><span style="mso-spacerun:'yes'; font-size:10.5000pt; font-family:'宋体'; ">0<font face="宋体">&le;</font><font face="Times New Roman">u</font><font face="宋体">，</font><font face="Times New Roman">v</font><font face="宋体">&le;</font><font face="Times New Roman">n-</font></span><span style="mso-spacerun:'yes'; font-size:10.5000pt; font-family:'Times New Roman'; ">1</span><span style="mso-spacerun:'yes'; font-size:10.5000pt; font-family:'宋体'; ">，</span><span style="mso-spacerun:'yes'; font-size:10.5000pt; font-family:'Times New Roman'; ">u&ne;v</span><span style="mso-spacerun:'yes'; font-size:10.5000pt; font-family:'宋体'; ">，<font face="Times New Roman">1</font><font face="宋体">&le;</font><font face="Times New Roman">t</font><font face="宋体">&le;</font><font face="Times New Roman">3600</font><font face="宋体">，表示公共汽车可以在</font><font face="Times New Roman">t</font><font face="宋体">秒的时间内直接在</font><font face="Times New Roman">u</font><font face="宋体">和</font><font face="Times New Roman">v</font><font face="宋体">之间到达（两个方向都可以）。</font></span><span style="mso-spacerun:'yes'; font-size:10.5000pt; font-family:'宋体'; "><o:p></o:p></span></p>
<p>【输出格式】</p>
<p class="p0" style="margin-bottom:0pt; margin-top:0pt; "><span style="mso-spacerun:'yes'; font-size:10.5000pt; font-family:'Times New Roman'; ">一个整数</span><span style="mso-spacerun:'yes'; font-size:10.5000pt; font-family:'宋体'; ">，</span><span style="mso-spacerun:'yes'; font-size:10.5000pt; font-family:'Times New Roman'; ">表示可能的最短路线的总耗时</span><span style="mso-spacerun:'yes'; font-size:10.5000pt; font-family:'宋体'; ">。</span><span style="mso-spacerun:'yes'; font-size:10.5000pt; font-family:'宋体'; "><o:p></o:p></span></p>
<p>【样例输入】</p>
<p class="p0" style="margin-bottom:0pt; margin-top:0pt; "><span style="mso-spacerun:'yes'; font-size:10.5000pt; font-family:'Times New Roman'; ">5&nbsp;4</span><span style="mso-spacerun:'yes'; font-size:10.5000pt; font-family:'Times New Roman'; "><o:p></o:p></span></p>
<p class="p0" style="margin-bottom:0pt; margin-top:0pt; "><span style="mso-spacerun:'yes'; font-size:10.5000pt; font-family:'Times New Roman'; ">	</span><span style="mso-spacerun:'yes'; font-size:10.5000pt; font-family:'Times New Roman'; ">0&nbsp;1&nbsp;10</span><span style="mso-spacerun:'yes'; font-size:10.5000pt; font-family:'Times New Roman'; "><o:p></o:p></span></p>
<p class="p0" style="margin-bottom:0pt; margin-top:0pt; "><span style="mso-spacerun:'yes'; font-size:10.5000pt; font-family:'Times New Roman'; ">	</span><span style="mso-spacerun:'yes'; font-size:10.5000pt; font-family:'Times New Roman'; ">1&nbsp;2&nbsp;20</span><span style="mso-spacerun:'yes'; font-size:10.5000pt; font-family:'Times New Roman'; "><o:p></o:p></span></p>
<p class="p0" style="margin-bottom:0pt; margin-top:0pt; "><span style="mso-spacerun:'yes'; font-size:10.5000pt; font-family:'Times New Roman'; ">	</span><span style="mso-spacerun:'yes'; font-size:10.5000pt; font-family:'Times New Roman'; ">2&nbsp;3&nbsp;30</span><span style="mso-spacerun:'yes'; font-size:10.5000pt; font-family:'Times New Roman'; "><o:p></o:p></span></p>
<p class="p0" style="margin-bottom:0pt; margin-top:0pt; "><span style="mso-spacerun:'yes'; font-size:10.5000pt; font-family:'Times New Roman'; ">	</span><span style="mso-spacerun:'yes'; font-size:10.5000pt; font-family:'Times New Roman'; ">3&nbsp;4&nbsp;40</span><span style="mso-spacerun:'yes'; font-size:10.5000pt; font-family:'宋体'; "><o:p></o:p></span></p>
<p>【样例输出】</p>
<p class="p0" style="margin-bottom:0pt; margin-top:0pt; "><span style="mso-spacerun:'yes'; font-size:10.5000pt; font-family:'Times New Roman'; ">300</span><span style="mso-spacerun:'yes'; font-size:10.5000pt; font-family:'宋体'; "><o:p></o:p></span></p>
<p>【数据规模和约定】</p>
<p class="p0" style="margin-bottom:0pt; margin-top:0pt; "><span style="mso-spacerun:'yes'; font-size:10.5000pt; font-family:'Times New Roman'; ">对于</span><span style="mso-spacerun:'yes'; font-size:10.5000pt; font-family:'宋体'; ">20%<font face="宋体">的数据：</font><font face="Times New Roman">n=</font></span><span style="mso-spacerun:'yes'; font-size:10.5000pt; font-family:'Times New Roman'; ">3</span><span style="mso-spacerun:'yes'; font-size:10.5000pt; font-family:'Times New Roman'; "><o:p></o:p></span></p>
<p class="p0" style="margin-bottom:0pt; margin-top:0pt; "><span style="mso-spacerun:'yes'; font-size:10.5000pt; font-family:'Times New Roman'; ">	</span><span style="mso-spacerun:'yes'; font-size:10.5000pt; font-family:'Times New Roman'; ">对于</span><span style="mso-spacerun:'yes'; font-size:10.5000pt; font-family:'宋体'; ">50%<font face="宋体">的数据：</font><font face="Times New Roman">3</font><font face="宋体">&le;</font><font face="Times New Roman">n</font><font face="宋体">&le;</font><font face="Times New Roman">10</font></span><span style="mso-spacerun:'yes'; font-size:10.5000pt; font-family:'宋体'; "><o:p></o:p></span></p>
<p class="p0" style="margin-bottom:0pt; margin-top:0pt; "><span style="mso-spacerun:'yes'; font-size:10.5000pt; font-family:'Times New Roman'; ">	</span><span style="mso-spacerun:'yes'; font-size:10.5000pt; font-family:'Times New Roman'; ">对于</span><span style="mso-spacerun:'yes'; font-size:10.5000pt; font-family:'宋体'; ">100%<font face="宋体">的数据：</font><font face="Times New Roman">3</font><font face="宋体">&le;</font><font face="Times New Roman">n</font><font face="宋体">&le;</font><font face="Times New Roman">20</font><font face="宋体">，</font><font face="Times New Roman">2</font><font face="宋体">&le;</font><font face="Times New Roman">m</font></span><span style="mso-spacerun:'yes'; font-size:10.5000pt; font-family:'宋体'; "><o:p></o:p></span></p>