<head>
    <meta charset="UTF-8">
<title>算法训练 Castles</title>
<link rel="stylesheet" href="../css/main.css">
</head>
 <div>【问题描述】</div>
<div>战争在世界历史中扮演了重要角色。与现代战争不同，中世纪的军队主要忙于夺取和控制贵族的私有设防住宅&mdash;&mdash;城堡。一个进攻军队的规模是军队夺取和控制这些建筑杰作的能力的重要影响因素。</div>
<div><img src="http://lx.lanqiao.cn/RequireFile.do?fid=hJat33dE" width="327" height="195" alt="" /></div>
<div>夺取城堡会使用最少需要的士兵数量。一些士兵在进攻中会死去。夺取城堡后，一些士兵被要求留在城堡里防卫其他军队的进攻。当然，留守的士兵数量根据不同的城堡而不同。军队指挥官有义务来考虑进攻成功需要的士兵数量。例如，图中有5个城堡，右下角的城堡需要至少20个士兵才能进攻成功，没有人在进攻中会死去，军队前进后10个士兵必须留在城堡里。</div>
<div>你需要确定一个军队夺取和控制一个特定地区的所有城堡所需要的最小规模。出于安全因素，该地区的任意一对城堡之间有且仅有一条路径。移动到相邻的未夺取城堡就会发动对该城堡的进攻。任何城堡都可以作为第一个被进攻的城堡，不用管军队是怎么到那里的。一旦某个城堡被夺取，要求的士兵数量被留在城堡里保卫它，若还有未夺取城堡，则军队剩余的人继续前进夺取其他城堡。军队可以安全到达已被夺取的城堡的相邻城堡。但由于被进攻的潜在可能，军队在同一方向上经过同一条路最多一次。</div>
<div>【输入格式】</div>
<div>第一行包含一个整数n，表示该地区的城堡数。</div>
<div>接下来n行每行包含三个整数a_i, m_i和g_i，表示成功夺取城堡i需要的最少士兵数量，在进攻中会死去的士兵数量和必须留守的士兵数量。</div>
<div>接下来n - 1行每行包含两个整数x_i和y_i，表示一条直接连接城堡x_i和城堡y_i的道路。</div>
<div>【输出格式】</div>
<div>一行包含一个整数，表示夺取和控制该地区的所有城堡所需要的最少士兵数量。</div>
<div>【样例输入】</div>
<div>3</div>
<div>5 5 5</div>
<div>10 5 5</div>
<div>5 1 1</div>
<div>1 3</div>
<div>2 3</div>
<div>【样例输出】</div>
<div>22</div>
<div>【样例输入】</div>
<div>5</div>
<div>10 5 10</div>
<div>20 10 5</div>
<div>10 10 5</div>
<div>5 5 5</div>
<div>20 0 10</div>
<div>1 2</div>
<div>1 3</div>
<div>1 4</div>
<div>3 5</div>
<div>【样例输出】</div>
<div>65</div>
<div>【数据规模和约定】</div>
<div>对于30%的数据，1 &lt;= n &lt;= 10。</div>
<div>对于100%的数据，1 &lt;= n &lt;= 100，1 &lt;= a_i &lt;= 1000，0 &lt;= m_i &lt;= a_i，1 &lt;= g_i &lt;= 1000。</div>